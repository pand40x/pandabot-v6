# üß© 10. Y√∂netici √ñzellikleri

## üë®‚Äçüíº Admin Panel

### Admin Tanƒ±mlama

```typescript
// Admin ID tanƒ±mlama (environment variable'dan)
const ADMIN_ID = process.env.ADMIN_ID;

function isAdmin(userId: number): boolean {
  return userId.toString() === ADMIN_ID;
}
```

---

## üîî Otomatik Bildirimler

### 1. üë§ Yeni Kullanƒ±cƒ± Bildirimi

**Tetikleme:** Yeni kullanƒ±cƒ± `/start` komutu g√∂nderdiƒüinde

**Admin'e G√∂nderilen Mesaj:**
```
üëã Yeni Kullanƒ±cƒ±!
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üÜî ID: 987654321
üë§ Ad: John Doe
üìù Kullanƒ±cƒ± Adƒ±: @johndoe
üìÖ ƒ∞lk Kullanƒ±m: 31.10.2025 14:30
üåç Dil: tr
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
```

**Kod:**
```typescript
// modules/users/handlers.ts
import { User } from './model';

bot.command('start', async (ctx) => {
  // Kullanƒ±cƒ±yƒ± veritabanƒ±na kaydet
  const user = await User.findOneAndUpdate(
    { telegramId: ctx.from.id },
    {
      telegramId: ctx.from.id,
      username: ctx.from.username,
      firstName: ctx.from.first_name,
      lastName: ctx.from.last_name,
      languageCode: ctx.from.language_code,
      lastActive: new Date()
    },
    { upsert: true, new: true }
  );
  
  // ƒ∞lk kez kaydediliyorsa admin'e bildir
  if (user.isNew) {
    await bot.api.sendMessage(
      ADMIN_ID,
      `üëã Yeni Kullanƒ±cƒ±!\n` +
      `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n` +
      `üÜî ID: ${ctx.from.id}\n` +
      `üë§ Ad: ${ctx.from.first_name}\n` +
      `üìù Kullanƒ±cƒ± Adƒ±: ${ctx.from.username ? '@' + ctx.from.username : 'Yok'}\n` +
      `üìÖ ƒ∞lk Kullanƒ±m: ${new Date().toLocaleString('tr-TR')}\n` +
      `üåç Dil: ${ctx.from.language_code || 'tr'}\n` +
      `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ`
    );
  }
  
  // Kullanƒ±cƒ±ya ho≈ü geldin mesajƒ±
  await ctx.reply(welcomeMessage);
});
```

---

### 2. üö´ Kullanƒ±cƒ± Engelleme Bildirimi

**Tetikleme:** Kullanƒ±cƒ± botu engellediƒüinde

**Admin'e G√∂nderilen Mesaj:**
```
üö´ Kullanƒ±cƒ± Engellendi
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üÜî ID: 987654321
üë§ Ad: John Doe
üìÖ Engellenme: 31.10.2025 14:35
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
```

**Otomatik Tespit:**
```typescript
// Hata yakalayarak engellemeyi tespit et
bot.catch((err) => {
  const ctx = err.ctx;
  const error = err.error;
  
  // 400 Bad Request: chat not found (blocked)
  if (error.message.includes('chat not found')) {
    User.findOneAndUpdate(
      { telegramId: ctx.from.id },
      { 
        isBlocked: true,
        blockedAt: new Date()
      }
    ).then(() => {
      bot.api.sendMessage(
        ADMIN_ID,
        `üö´ Kullanƒ±cƒ± Engellendi\n` +
        `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n` +
        `üÜî ID: ${ctx.from.id}\n` +
        `üë§ Ad: ${ctx.from.first_name}\n` +
        `üìÖ Engellenme: ${new Date().toLocaleString('tr-TR')}\n` +
        `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ`
      );
    });
  }
});
```

---

### 3. ‚ö†Ô∏è Sistem Hatasƒ± Bildirimi

**Tetikleme:** Kritik hata olu≈ütuƒüunda

**Admin'e G√∂nderilen Mesaj:**
```
‚ö†Ô∏è Sistem Hatasƒ±
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üïê Zaman: 31.10.2025 14:40
üìç Mod√ºl: alerts
üë§ Kullanƒ±cƒ±: 987654321
‚ùå Hata: MongoDB connection failed
üîó Stack: /src/modules/alerts/handler.ts:45
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
```

**Kod:**
```typescript
// core/logger.ts
export async function notifyAdminOfError(error: Error, context?: any) {
  const message = 
    `‚ö†Ô∏è Sistem Hatasƒ±\n` +
    `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n` +
    `üïê Zaman: ${new Date().toLocaleString('tr-TR')}\n` +
    `${context ? `üìç Mod√ºl: ${context.module || 'unknown'}\n` : ''}` +
    `${context?.userId ? `üë§ Kullanƒ±cƒ±: ${context.userId}\n` : ''}` +
    `‚ùå Hata: ${error.message}\n` +
    `${error.stack ? `üîó Stack: ${error.stack.split('\n')[1]}\n` : ''}` +
    `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ`;
  
  try {
    await bot.api.sendMessage(ADMIN_ID, message);
  } catch (notifyError) {
    console.error('Failed to notify admin:', notifyError);
  }
}

// Kullanƒ±m
try {
  await someOperation();
} catch (error) {
  await notifyAdminOfError(error, { 
    module: 'alerts',
    userId: ctx.from.id 
  });
}
```

---

### 4. üìä G√ºnl√ºk √ñzet

**Tetikleme:** Her g√ºn saat 00:00'da

**Admin'e G√∂nderilen Mesaj:**
```
üìä G√ºnl√ºk √ñzet - 31.10.2025
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üë• Kullanƒ±cƒ±lar
  üÜï Yeni: 45
  üëÄ Aktif: 234
  üö´ Engellenen: 2

üìù Komutlar
  ‚≠ê Toplam: 1,567
  ‚úÖ Ba≈üarƒ±lƒ±: 1,542 (98.4%)
  ‚ùå Ba≈üarƒ±sƒ±z: 25 (1.6%)

‚è∞ Hatƒ±rlatmalar
  üìÖ Olu≈üturulan: 89
  üîî G√∂nderilen: 87 (97.8%)
  ‚ùå Ka√ßƒ±rƒ±lan: 2

üîî Alarmlar
  üü¢ Aktif: 156
  ‚ö° Tetiklenen: 23
  üìä Doƒüruluk: 99.6%

ü§ñ AI
  üí¨ Sorgu: 345
  ‚è±Ô∏è Ort. S√ºre: 1.2s
  ‚ùå Hata: 3 (0.9%)

‚öôÔ∏è Sistem
  üìà Ort. Yanƒ±t: 1.3s
  ‚è±Ô∏è Uptime: 99.97%
  üñ•Ô∏è Bellek: 245 MB
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
```

**Kod:**
```typescript
// jobs/daily-summary.js
import agenda from '../core/agenda';

agenda.define('send-daily-summary', async (job) => {
  const today = new Date();
  const startOfDay = new Date(today.getFullYear(), today.getMonth(), today.getDate());
  
  // Metrikleri topla
  const metrics = await collectDailyMetrics(startOfDay);
  
  const message = formatDailySummary(metrics);
  
  await bot.api.sendMessage(ADMIN_ID, message);
});

// Her g√ºn 00:00'da √ßalƒ±≈ütƒ±r
agenda.every('1 day', 'send-daily-summary', {
  // UTC 21:00 (T√ºrkiye i√ßin 00:00)
  hour: 21,
  minute: 0
});
```

---

## üìä Admin Komutlarƒ±

### 1. `/stats` - Sistem ƒ∞statistikleri

**Kullanƒ±m:** Sadece admin

**√ñrnek √áƒ±ktƒ±:**
```
üìä Sistem ƒ∞statistikleri
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üë• Kullanƒ±cƒ±lar
  Toplam: 8,934
  Aktif (24s): 1,256
  Engelli: 23
  Yeni (bug√ºn): 45

üìù Komutlar (Son 24s)
  Toplam: 1,567
  Ba≈üarƒ±lƒ±: 1,542
  Ba≈üarƒ±sƒ±z: 25
  Hata Oranƒ±: 1.6%

‚è∞ Hatƒ±rlatmalar
  Aktif: 234
  Bekleyen: 89
  Bug√ºn G√∂nderilen: 87
  Doƒüruluk: 97.8%

üîî Alarmlar
  Aktif: 156
  Bug√ºn Tetiklenen: 23
  En Pop√ºler: BTC (45)

ü§ñ AI
  Sorgu (bug√ºn): 345
  Ort. Yanƒ±t S√ºresi: 1.2s
  Hata Oranƒ±: 0.9%

‚öôÔ∏è Sistem
  Uptime: 99.97% (7 g√ºn)
  Ort. Yanƒ±t S√ºresi: 1.3s
  Bellek Kullanƒ±mƒ±: 245 MB
  MongoDB Baƒülantƒ±sƒ±: ‚úÖ
  External APIs: ‚úÖ
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
```

**Kod:**
```typescript
bot.command('stats', async (ctx) => {
  // Admin kontrol√º
  if (!isAdmin(ctx.from.id)) {
    await ctx.reply('‚ùå Bu komutu kullanma yetkiniz yok.');
    return;
  }
  
  // Metrikleri topla
  const stats = await getSystemStats();
  
  // Formatla ve g√∂nder
  const message = formatStats(stats);
  await ctx.reply(message);
});

async function getSystemStats() {
  const [
    totalUsers,
    activeUsers,
    blockedUsers,
    newUsersToday,
    totalCommands,
    successfulCommands,
    failedCommands,
    activeReminders,
    pendingReminders,
    activeAlerts
  ] = await Promise.all([
    User.countDocuments(),
    User.countDocuments({ lastActive: { $gte: yesterday } }),
    User.countDocuments({ isBlocked: true }),
    User.countDocuments({ firstSeen: { $gte: startOfDay } }),
    Log.countDocuments({ action: 'command', timestamp: { $gte: yesterday } }),
    Log.countDocuments({ action: 'command_success', timestamp: { $gte: yesterday } }),
    Log.countDocuments({ action: 'command_error', timestamp: { $gte: yesterday } }),
    Reminder.countDocuments({ status: 'active' }),
    Reminder.countDocuments({ remindAt: { $gte: new Date() }, status: 'active' }),
    Alert.countDocuments({ status: 'active' })
  ]);
  
  return {
    users: {
      total: totalUsers,
      active: activeUsers,
      blocked: blockedUsers,
      newToday: newUsersToday
    },
    commands: {
      total: totalCommands,
      successful: successfulCommands,
      failed: failedCommands,
      errorRate: failedCommands / totalCommands * 100
    },
    reminders: {
      active: activeReminders,
      pending: pendingReminders
    },
    alerts: {
      active: activeAlerts
    }
  };
}
```

---

### 2. `/users` - Kullanƒ±cƒ± Listesi

**Kullanƒ±m:** `/users` veya `/users <SAYFA>`

**√ñrnek √áƒ±ktƒ±:**
```
üë• Kullanƒ±cƒ±lar (Sayfa 1/12)
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
1. üë§ John Doe (@johndoe)
   üÜî ID: 123456789
   üìÖ Son Aktivite: 2 saat √∂nce
   üìä Komutlar: 45

2. üë§ Jane Smith (@janesmith)
   üÜî ID: 987654321
   üìÖ Son Aktivite: 1 g√ºn √∂nce
   üìä Komutlar: 12

3. üë§ Bob Wilson
   üÜî ID: 555666777
   üìÖ Son Aktivite: 3 g√ºn √∂nce
   üìä Komutlar: 8
   ‚ö†Ô∏è Engelli
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üìÑ Sayfalama: 1 2 3 ... 12
```

**Kod:**
```typescript
bot.command('users', async (ctx) => {
  if (!isAdmin(ctx.from.id)) {
    await ctx.reply('‚ùå Bu komutu kullanma yetkiniz yok.');
    return;
  }
  
  const page = parseInt(ctx.match) || 1;
  const limit = 10;
  const skip = (page - 1) * limit;
  
  const users = await User.find()
    .sort({ lastActive: -1 })
    .skip(skip)
    .limit(limit);
  
  const totalUsers = await User.countDocuments();
  const totalPages = Math.ceil(totalUsers / limit);
  
  const message = formatUsersList(users, page, totalPages);
  await ctx.reply(message);
});
```

---

### 3. `/ban <USER_ID>` - Kullanƒ±cƒ± Engelleme

**Kullanƒ±m:** `/ban 123456789`

**√ñrnek √áƒ±ktƒ±:**
```
‚úÖ Kullanƒ±cƒ± engellendi
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üÜî ID: 123456789
üë§ Ad: John Doe
üìÖ Engellenme: 31.10.2025 14:50
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
```

**Kod:**
```typescript
bot.command('ban', async (ctx) => {
  if (!isAdmin(ctx.from.id)) {
    await ctx.reply('‚ùå Bu komutu kullanma yetkiniz yok.');
    return;
  }
  
  const userId = parseInt(ctx.match);
  
  if (!userId) {
    await ctx.reply('‚ùå Ge√ßersiz kullanƒ±cƒ± ID.\n√ñrnek: /ban 123456789');
    return;
  }
  
  const user = await User.findOneAndUpdate(
    { telegramId: userId },
    { 
      isBlocked: true,
      blockedAt: new Date(),
      blockedReason: 'Manual ban'
    },
    { new: true }
  );
  
  if (!user) {
    await ctx.reply('‚ùå Kullanƒ±cƒ± bulunamadƒ±.');
    return;
  }
  
  await ctx.reply(
    `‚úÖ Kullanƒ±cƒ± engellendi\n` +
    `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n` +
    `üÜî ID: ${userId}\n` +
    `üë§ Ad: ${user.firstName}\n` +
    `üìÖ Engellenme: ${new Date().toLocaleString('tr-TR')}\n` +
    `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ`
  );
});
```

---

### 4. `/unban <USER_ID>` - Engeli Kaldƒ±rma

**Kullanƒ±m:** `/unban 123456789`

**√ñrnek √áƒ±ktƒ±:**
```
‚úÖ Kullanƒ±cƒ±nƒ±n engeli kaldƒ±rƒ±ldƒ±
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üÜî ID: 123456789
üë§ Ad: John Doe
üìÖ Kaldƒ±rma: 31.10.2025 14:55
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
```

---

### 5. `/logs` - Sistem Loglarƒ±

**Kullanƒ±m:** `/logs` veya `/logs <SAYI>` (son N log)

**√ñrnek √áƒ±ktƒ±:**
```
üìã Son 10 Log
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
14:55:23 [INFO] user:123456789 command:price symbol:BTC
14:55:20 [INFO] reminder:1234 sent to user:987654321
14:55:18 [WARN] API:binance rate limit warning
14:55:15 [ERROR] alert:567 failed to trigger user:111222333
14:55:10 [INFO] user:555666777 started bot
14:55:05 [INFO] AI query from user:123456789
14:54:58 [INFO] alert:123 triggered user:987654321
14:54:50 [INFO] command:note add by user:555666777
14:54:45 [WARN] MongoDB connection pool low
14:54:40 [INFO] system startup completed
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
```

---

### 6. `/broadcast <MESSAGE>` - Toplu Mesaj G√∂nderme

**Kullanƒ±m:** `/broadcast T√ºm kullanƒ±cƒ±lara g√∂nderilecek mesaj`

**√ñrnek √áƒ±ktƒ±:**
```
üì¢ Mesaj g√∂nderiliyor...
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üë• Hedef: 1,256 aktif kullanƒ±cƒ±
‚úÖ G√∂nderildi: 1,198 (95.4%)
‚ùå Ba≈üarƒ±sƒ±z: 58
‚è±Ô∏è S√ºre: 3.2 dakika
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
```

**Kod:**
```typescript
bot.command('broadcast', async (ctx) => {
  if (!isAdmin(ctx.from.id)) {
    await ctx.reply('‚ùå Bu komutu kullanma yetkiniz yok.');
    return;
  }
  
  const message = ctx.match;
  
  if (!message) {
    await ctx.reply('‚ùå Mesaj i√ßeriƒüi gerekli.\n√ñrnek: /broadcast Bakƒ±m √ßalƒ±≈ümasƒ± yapƒ±lacak');
    return;
  }
  
  await ctx.reply('üì¢ Mesaj g√∂nderiliyor...');
  
  // Aktif kullanƒ±cƒ±larƒ± al (son 7 g√ºn i√ßinde aktif)
  const activeUsers = await User.find({
    lastActive: { $gte: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000) },
    isBlocked: false
  });
  
  let sent = 0;
  let failed = 0;
  
  // Batch'ler halinde g√∂nder (rate limiting i√ßin)
  const batchSize = 20;
  for (let i = 0; i < activeUsers.length; i += batchSize) {
    const batch = activeUsers.slice(i, i + batchSize);
    
    await Promise.all(
      batch.map(async (user) => {
        try {
          await bot.api.sendMessage(user.telegramId, 
            `üì¢ Duyuru\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n${message}\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ`
          );
          sent++;
        } catch (error) {
          failed++;
        }
      })
    );
    
    // Rate limiting - batch'ler arasƒ± bekle
    if (i + batchSize < activeUsers.length) {
      await new Promise(resolve => setTimeout(resolve, 1000));
    }
  }
  
  await ctx.reply(
    `üì¢ Mesaj g√∂nderildi\n` +
    `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n` +
    `üë• Hedef: ${activeUsers.length} aktif kullanƒ±cƒ±\n` +
    `‚úÖ G√∂nderildi: ${sent}\n` +
    `‚ùå Ba≈üarƒ±sƒ±z: ${failed}\n` +
    `‚è±Ô∏è S√ºre: ${Math.round((activeUsers.length / 20))} batch\n` +
    `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ`
  );
});
```

---

### 7. `/backup` - Veritabanƒ± Yedeƒüi

**Kullanƒ±m:** `/backup`

**√ñrnek √áƒ±ktƒ±:**
```
üíæ Yedekleme ba≈ülatƒ±ldƒ±
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üìä Users: 8,934
üìä Notes: 12,456
üìä Reminders: 567
üìä Alerts: 234
üìä UserLists: 1,234
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
```

---

### 8. `/restart` - Bot Yeniden Ba≈ülatma

**Kullanƒ±m:** `/restart`

**√ñrnek √áƒ±ktƒ±:**
```
üîÑ Bot yeniden ba≈ülatƒ±lƒ±yor...
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
‚è±Ô∏è ƒ∞≈ülemler durduruluyor...
üíæ Veriler kaydediliyor...
üñ•Ô∏è Sistem yeniden ba≈ülatƒ±lƒ±yor...
‚úÖ Ba≈ülatƒ±ldƒ±!
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
```

**G√ºvenlik:**
```typescript
bot.command('restart', async (ctx) => {
  if (!isAdmin(ctx.from.id)) {
    await ctx.reply('‚ùå Bu komutu kullanma yetkiniz yok.');
    return;
  }
  
  await ctx.reply('üîÑ Bot yeniden ba≈ülatƒ±lƒ±yor...');
  
  // Graceful shutdown
  setTimeout(() => {
    process.exit(0);
  }, 1000);
});
```

---

## üîê Admin G√ºvenliƒüi

### ƒ∞ki Fakt√∂rl√º Doƒürulama (2FA)

```typescript
// Admin panel (gelecek)
/*
1. Kullanƒ±cƒ± admin ID'sini doƒürular
2. OTP kodu email/SMS ile g√∂nderilir
3. Kullanƒ±cƒ± kodu girer
4. Yetki verilir
*/
```

### Admin Komut Loglamasƒ±

```typescript
// T√ºm admin komutlarƒ± loglanƒ±r
bot.command(/^(stats|users|ban|unban|broadcast|logs|backup|restart)/, async (ctx) => {
  logger.info({
    action: 'admin_command',
    command: ctx.match,
    adminId: ctx.from.id,
    timestamp: new Date()
  });
});
```

---

## üì± Telegram Admin Bot

Basit bir admin bot olu≈üturarak y√∂netim i≈ülemlerini kolayla≈ütƒ±rabiliriz:

```
Admin Bot (@PandaBotAdmin)
‚îú‚îÄ‚îÄ Dashboard (Ana sayfa)
‚îú‚îÄ‚îÄ Users (Kullanƒ±cƒ±lar)
‚îú‚îÄ‚îÄ Alerts (Alarmlar)
‚îú‚îÄ‚îÄ Logs (Loglar)
‚îú‚îÄ‚îÄ Broadcast (Toplu mesaj)
‚îî‚îÄ‚îÄ Settings (Ayarlar)
```

**Avantajlar:**
- ‚úÖ Telegram √ºzerinden kolay y√∂netim
- ‚úÖ Her yerden eri≈üim
- ‚úÖ Bildirimler anƒ±nda gelir
- ‚úÖ Mobil uyumlu
- ‚úÖ Basit aray√ºz

---

## üìä Admin Dashboard (Gelecek - v2.0)

Web tabanlƒ± y√∂netim paneli:

### Sayfalar

1. **Dashboard** - Genel bakƒ±≈ü
2. **Users** - Kullanƒ±cƒ± y√∂netimi
3. **Alerts** - Alarm y√∂netimi
4. **Reminders** - Hatƒ±rlatma y√∂netimi
5. **Analytics** - ƒ∞statistikler
6. **Settings** - Konfig√ºrasyon

### √ñzellikler

- **Filtreleme ve arama**
- **CSV export**
- **Toplu i≈ülemler**
- **Grafik ve chartlar**
- **Real-time g√ºncellemeler**
- **Rol bazlƒ± eri≈üim**

---

**Bir sonraki b√∂l√ºm:** [Project Structure](./11-folder-structure.md)
